<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8" />
    <title>Oyun Olu≈ütur</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
</head>

<body class="p-4">
    <h2>Yeni Oyun Olu≈ütur</h2>

    <form id="createGameForm" class="mb-3">
        <div class="mb-3">
            <label for="hostName" class="form-label">Oyunu Kuran (Host) Adƒ±</label>
            <input type="text" id="hostName" class="form-control" placeholder="Adƒ±nƒ±zƒ± yazƒ±n" required />
        </div>
        <div class="mb-3">
            <label for="roundTime" class="form-label">Tur S√ºresi (saniye)</label>
            <input type="number" id="roundTime" class="form-control" value="20" min="5" max="120" required />
        </div>
        <button type="submit" class="btn btn-primary">Oyun Olu≈ütur</button>
    </form>

    <div id="result" class="alert alert-success d-none"></div>
    <button id="goLobbyBtn" class="btn btn-secondary d-none">Lobiye Git</button>

    <script>
        const form = document.getElementById('createGameForm');
        const resultDiv = document.getElementById('result');
        const goLobbyBtn = document.getElementById('goLobbyBtn');
        let currentGameId = null;

        form.addEventListener('submit', async (e) => {
            e.preventDefault();

            const hostName = document.getElementById('hostName').value.trim();
            const roundTime = parseInt(document.getElementById('roundTime').value);

            if (!hostName) {
                alert("L√ºtfen isminizi girin.");
                return;
            }

            try {
                const res = await fetch('http://192.168.1.118:8000/create-game', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ host_name: hostName, round_time: roundTime })
                });

                if (!res.ok) throw new Error('Oyun olu≈üturulamadƒ±.');

                const data = await res.json();

                // üîÅ Burada y√∂nlendiriyoruz:
                window.location.href = `lobby.html?game_id=${data.game_id}&host=${encodeURIComponent(hostName)}`;

            } catch (err) {
                alert(err.message);
            }
        });

        goLobbyBtn.addEventListener('click', () => {
            if (currentGameId) {
                window.location.href = `lobby.html?game_id=${currentGameId}`;
            }
        });
    </script>
</body>

</html>